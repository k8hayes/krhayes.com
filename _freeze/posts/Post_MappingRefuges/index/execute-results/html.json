{
  "hash": "cdf7906ff95b8004a0b77fc7972c1bb7",
  "result": {
    "markdown": "---\ntitle: How much of Alaska is a National Wildlife Refuge?\nsubtitle: Mapping in terra\ndescription: Ft. pretty maps\ndate: 2024-10-14\ncategories: [Spatial Data Analysis]\ndate-modified: last-modified\n---\n\n\nWe're starting a [new project](https://www.caryinstitute.org/news-insights/press-release/new-project-will-inform-firefighting-efforts-maximize-carbon-storage) to map carbon vulnerability and help land managers make decisions about carbon management in National Wildlife Refuges in Alaska.\n\nWhile Alaska is home to just 16 of the 570 refuges spread across the United States, according to the [Friends of Alaskan Wildlife Refuge System](https://alaskarefugefriends.org/category/call-to-action/), those 16 make up nearly 85% of the refuge system's 95 million acres, clocking in at a cool 80 million acres of land.\n\nBut, Alaska is big. How much of the 80 million acres is NWR?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(terra)\nlibrary(tidyterra)\nlibrary(kableExtra)\n```\n:::\n\n\nI'm loading a shapefile of the boundary of Alaska, originally sourced from a USGS dataset and reprojected to Alaska Albers in QGIS.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalaska = vect(\"/Users/katherinehayes/Google Drive/Work/Website/krhayes.com/posts/Post_MappingRefuges/data/AK_boundary.shp\")\ncrs(alaska)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"PROJCRS[\\\"NAD83 / Alaska Albers\\\",\\n    BASEGEOGCRS[\\\"NAD83\\\",\\n        DATUM[\\\"North American Datum 1983\\\",\\n            ELLIPSOID[\\\"GRS 1980\\\",6378137,298.257222101,\\n                LENGTHUNIT[\\\"metre\\\",1]]],\\n        PRIMEM[\\\"Greenwich\\\",0,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433]],\\n        ID[\\\"EPSG\\\",4269]],\\n    CONVERSION[\\\"Alaska Albers (meters)\\\",\\n        METHOD[\\\"Albers Equal Area\\\",\\n            ID[\\\"EPSG\\\",9822]],\\n        PARAMETER[\\\"Latitude of false origin\\\",50,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8821]],\\n        PARAMETER[\\\"Longitude of false origin\\\",-154,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8822]],\\n        PARAMETER[\\\"Latitude of 1st standard parallel\\\",55,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8823]],\\n        PARAMETER[\\\"Latitude of 2nd standard parallel\\\",65,\\n            ANGLEUNIT[\\\"degree\\\",0.0174532925199433],\\n            ID[\\\"EPSG\\\",8824]],\\n        PARAMETER[\\\"Easting at false origin\\\",0,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8826]],\\n        PARAMETER[\\\"Northing at false origin\\\",0,\\n            LENGTHUNIT[\\\"metre\\\",1],\\n            ID[\\\"EPSG\\\",8827]]],\\n    CS[Cartesian,2],\\n        AXIS[\\\"easting (X)\\\",east,\\n            ORDER[1],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n        AXIS[\\\"northing (Y)\\\",north,\\n            ORDER[2],\\n            LENGTHUNIT[\\\"metre\\\",1]],\\n    USAGE[\\n        SCOPE[\\\"Topographic mapping (small scale).\\\"],\\n        AREA[\\\"United States (USA) - Alaska.\\\"],\\n        BBOX[51.3,172.42,71.4,-129.99]],\\n    ID[\\\"EPSG\\\",3338]]\"\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot() +\n  geom_spatvector(data = alaska) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/alaska shapefile-1.png){width=672}\n:::\n:::\n\n\nBut, I don't need all of the jurisdictional distinctions. I can use the *aggregate()* function in **terra** to lose the detail.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalaska = terra::aggregate(alaska, by = \"state_name\")\n\nggplot() +\n  geom_spatvector(data = alaska, fill = \"grey\", alpha = 0.75)+\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nSo minimal! So elegant!\n\nNow I can bring in the National Wildlife Refuge shapefile:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrefuge = vect(\"/Users/katherinehayes/Google Drive/Work/Website/krhayes.com/posts/Post_MappingRefuges/data/Boundaries_Refuge.shp\")\ncrs(refuge) = crs(alaska) # check that it has the same projection\n\nggplot() +\n  geom_spatvector(data = refuge,\n                  aes(fill = NWRNAME, color = NWRNAME)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nWhat's hard to tell from the plot above, is that the **refuge** spatial vector is made up of a ton of polygons.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nterra::nrow(refuge)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5445\n```\n\n\n:::\n:::\n\n\nSimilar to the state shapefile, I can aggregate so each refuge is represented by a single polygon:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrefuge <- terra::aggregate(refuge, by = \"NWRNAME\")\n\nterra::nrow(refuge)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 16\n```\n\n\n:::\n\n```{.r .cell-code}\nggplot() +\n  geom_spatvector(data = refuge,\n                  aes(fill = NWRNAME, color = NWRNAME)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n(The difference is again, mostly internal, but 5445 polygons down to 16 makes the object a bit easier to handle).\n\nI also want to use the full names for refuges, not the acronyms. Here's an ifelse chain to rename them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrefuge = refuge %>%\n  mutate(Name = ifelse(NWRNAME == \"akm\", \"Alaska Maritime\",\n                     ifelse(NWRNAME == \"akp\", \"Alaska Peninsula\",\n                          ifelse(NWRNAME == \"arc\", \"Arctic\",\n                               ifelse(NWRNAME == \"bch\", \"Bercharof\",\n                                    ifelse(NWRNAME == \"inn\", \"Innoko\",\n                                         ifelse(NWRNAME == \"izm\", \"Izembek\",\n                ifelse(NWRNAME == \"kan\", \"Kanuti\",\n                      ifelse(NWRNAME == \"kdk\", \"Kodiak\",\n                          ifelse(NWRNAME == \"kna\", \"Kenai\",\n                                ifelse(NWRNAME == \"kuk\", \"Koyukuk\",\n                                      ifelse(NWRNAME == \"now\", \"Nowitna\",\n                ifelse(NWRNAME == \"swk\", \"Selawik\",\n                     ifelse(NWRNAME == \"tet\", \"Tetlin\",\n                          ifelse(NWRNAME == \"tgk\", \"Togiak\",\n                               ifelse(NWRNAME == \"ykd\", \"Yukon Delta\",\"Yukon Flats\"))))))))))))))))\n```\n:::\n\n\nNow I can go ahead and plot the NWR against the AK boundary:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_spatvector(data = alaska, fill = \"grey\", alpha = 0.75, color = NA)+\n  theme_minimal() + \n  geom_spatvector(data = refuge, aes(fill = Name), \n                  color = NA, alpha = 0.9) + \n  scale_fill_manual(\n    values = c(\"#fbe183\", \"#f4c40f\", \"#fe9b00\", \"#d8443c\", \"#9b3441\",\n               \"#de597c\", \"#e87b89\", \"#e6a2a6\", \"#aa7aa1\", \"#9f5691\",\n               \"#633372\", \"#1f6e9c\", \"#abd9e9\", \"#2b9b81\", \"#92c051\", \"#1b7837\")) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nA few things: one, the map of Alaska isn't terribly high-resolution - note the difference in coastline between the Alaska shapefile and the Alaska Peninsula NWR. I found a higher-resolution shapefile from the Alaska Department of Natural Resources, linked [here](https://gis.data.alaska.gov/datasets/SOA-DNR::alaska-coastline/explore?layer=0). Let's see if it makes a difference:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nalaska_hires = vect(\"/Users/katherinehayes/Google Drive/Work/Website/krhayes.com/posts/Post_MappingRefuges/data/AK_hires.shp\")\n\ncrs(alaska_hires) = crs(refuge)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() +\n  geom_spatvector(data = alaska_hires, fill = \"grey\", alpha = 0.75, color = NA)+\n  theme_minimal() + \n  geom_spatvector(data = refuge, aes(fill = Name), \n                  color = NA, alpha = 0.9) + \n  scale_fill_manual(\n    values = c(\"#fbe183\", \"#f4c40f\", \"#fe9b00\", \"#d8443c\", \"#9b3441\",\n               \"#de597c\", \"#e87b89\", \"#e6a2a6\", \"#aa7aa1\", \"#9f5691\",\n               \"#633372\", \"#1f6e9c\", \"#abd9e9\", \"#2b9b81\", \"#92c051\", \"#1b7837\")) \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nMuch better!!\n\nNow, we can use the *expanse()* function in **terra** to calculate the area covered by polygons. I'll start by testing it with the refuge shapefile. Here's the raw output:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nround(expanse(refuge, unit = \"ha\", transform = FALSE) * 2.471)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1]  5759488  4918089 19848447  1457981  4566151   417387  1636779  1721743\n [9]  1985975  4498293  2056418  3220065   931457  4712266 24071626 11176296\n```\n\n\n:::\n:::\n\n\n(nice that it calculates for each NWR) - and here's a pretty table:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnwr_names = c(\"Alaska Maritime\", \"Alaska Peninsula\",\"Arctic\",\n               \"Bercharof\", \"Innoko\",\"Izembek\",\"Kanuti\",\"Kodiak\",\n               \"Kenai\",\"Koyukuk\",\"Nowitna\",\"Selawik\",\"Tetlin\",\"Togiak\",\n               \"Yukon Delta\",\"Yukon Flats\")\n\nrefuge_acre = data.frame(NWR = nwr_names,\n                         acres = round(expanse(refuge,\n                                 unit = \"ha\", transform = FALSE) * \n                                   2.471))\n\nkable(refuge_acre)\n```\n\n::: {.cell-output-display}\n\n\n|NWR              |    acres|\n|:----------------|--------:|\n|Alaska Maritime  |  5759488|\n|Alaska Peninsula |  4918089|\n|Arctic           | 19848447|\n|Bercharof        |  1457981|\n|Innoko           |  4566151|\n|Izembek          |   417387|\n|Kanuti           |  1636779|\n|Kodiak           |  1721743|\n|Kenai            |  1985975|\n|Koyukuk          |  4498293|\n|Nowitna          |  2056418|\n|Selawik          |  3220065|\n|Tetlin           |   931457|\n|Togiak           |  4712266|\n|Yukon Delta      | 24071626|\n|Yukon Flats      | 11176296|\n\n\n:::\n:::\n\n\nSome of the numbers are a bit different than what I found online: the [Yukon Flats Wikipedia](https://en.wikipedia.org/wiki/Yukon_Flats_National_Wildlife_Refuge) puts it at 8.6 million acres, while the [US Fish and Wildlife website](https://www.fws.gov/refuge/yukon-flats/about-us) says it's 11.1 million acres. There's similar discrepancies with the Togiak - wikipedia says 4.1 million acres, Fish and Wildlife [doesn't specify](https://www.fws.gov/refuge/togiak/about-us) but [other travel sites](https://www.travelalaska.com/destinations/parks-public-lands/togiak-national-wildlife-refuge) says the 4.7 million acre number the shapefile shows.\n\nMy best working guess is the distinction between NWR and Wildnerness - the NWR shapefile may include areas of Wildnerness.\n\nSo, what is that combined?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(round(expanse(refuge, unit = \"ha\", transform = FALSE)*2.471))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 92978461\n```\n\n\n:::\n:::\n\n\n92 million acres - definitely larger than the website's 80 million acre sum. Again, makes it seem like there's wilderness areas within the shapefile.\n\nWorking with this file for now, how much of the State of Alaska is NWR?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(round(expanse(refuge, unit = \"ha\", transform = FALSE)*2.471)) / \nsum(round(expanse(alaska_hires, unit = \"ha\", transform = FALSE)*2.471)) * 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 24.92743\n```\n\n\n:::\n:::\n\n\nSo, 25%. Considering the size of the state, that's a tremendous amount of landscape.",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}